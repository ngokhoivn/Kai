<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0a">
    <title>Kaiwa App - Bài 4</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/Kaiwa_UI.css">
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <a href="index.html" class="btn-home">
                <i class="fas fa-home"></i> Trang chủ
            </a>
            <div class="progress-container">
                <div class="progress-header">
                    <span>Tiến độ học tập</span>
                    <div class="progress-stats">
                        <div class="progress-stat"><i class="fas fa-trophy"></i> <span id="score">0</span></div>
                        <div class="progress-stat"><i class="fas fa-fire"></i> <span id="streak">0</span></div>
                        <div class="progress-stat"><i class="fas fa-book"></i> <span id="current-question">1</span>/<span id="total-questions">5</span></div>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            <div class="character-select-wrapper">
                <button type="button" class="character-select-toggle" id="character-select-toggle">
                    <i class="fas fa-user"></i>
                    <span>Chọn nhân vật</span>
                </button>
                <div id="character-selection" class="character-dropdown"></div>
            </div>
        </div>

        <div class="game-area">
            <div class="character-profile" id="character-profile"></div>

            <div class="conversation-area">
                <div class="question-box">
                    <div class="question-text" id="question-text">このひと は だれですか？</div>
                    <div class="question-translation" id="question-translation">Người này là ai?</div>
                    <button class="speak-question-btn" id="speak-question-btn">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </div>

                <div class="sentence-builder">
                    <div class="sentence-preview" id="sentence-preview">
                        <span class="empty-slot"></span>
                    </div>
                    <div class="controls-interactive">
                        <label class="toggle-switch">
                            <input type="checkbox" id="toggle-hints-checkbox" checked>
                            <span class="slider"></span>
                        </label>
                        <label for="toggle-hints-checkbox">Hiện gợi ý</label>
                    </div>
                    <div class="word-blocks-container" id="word-blocks-container"></div>
                </div>

                <div class="result" id="result"></div>

                <div class="controls">
                    <button class="btn btn-check" id="check-btn">
                        <i class="fas fa-check"></i> Kiểm tra
                    </button>
                    <button class="btn btn-next" id="next-btn">
                        <i class="fas fa-arrow-right"></i> Tiếp theo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="data/Kaiwa_Bai4_characters.js"></script>
    <script src="data/Kaiwa_Bai4_questions.js"></script>
    <script src="js/Kaiwa_Main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const wrapper = document.querySelector('.character-select-wrapper');
            const toggleBtn = document.getElementById('character-select-toggle');
            const dropdown = document.getElementById('character-selection');

            if (!wrapper || !toggleBtn || !dropdown) return;

            toggleBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                dropdown.classList.toggle('open');
            });

            document.addEventListener('click', function (e) {
                if (!dropdown.contains(e.target) && !toggleBtn.contains(e.target)) {
                    dropdown.classList.remove('open');
                }
            });
        });
    </script>
</body>
</html>
